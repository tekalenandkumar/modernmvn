package com.modernmvn.backend.dto;

import java.util.List;

/**
 * Full vulnerability report for a specific GAV (groupId:artifactId:version).
 * Contains all known advisories plus summary metrics.
 */
public record VulnerabilityReport(
        String groupId,
        String artifactId,
        String version,
        int totalVulnerabilities,
        int criticalCount,
        int highCount,
        int mediumCount,
        int lowCount,
        SecurityAdvisory.Severity highestSeverity,
        List<SecurityAdvisory> advisories,
        String disclaimer) {

    /** A report with zero vulnerabilities. */
    public static VulnerabilityReport clean(String groupId, String artifactId, String version) {
        return new VulnerabilityReport(
                groupId, artifactId, version,
                0, 0, 0, 0, 0,
                null,
                List.of(),
                DISCLAIMER);
    }

    public static final String DISCLAIMER = "Security data is sourced from OSV.dev and may not be exhaustive. " +
            "This information is provided as-is for informational purposes only. " +
            "Always conduct your own security review before using any library in production.";
}
